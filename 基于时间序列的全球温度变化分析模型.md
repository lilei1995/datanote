# 基于时间序列的全球温度变化分析模型

  项目简述主要通过收集1881年以来影响气候变化的因素数据。首先采用**插值拟合法**对残缺数据进行预先处理再进行影响因素主成份分析。将影响气候变化的因素使用气候因子来表示，气候因子包含温度变化和降水量变化；本题采用数学换算将气温变化、太阳辐射、温室气体排放等因素均换算为辐射强迫，以此来同一量纲方便数据处理。使用**ARIMA-BP混合模型**对影响气候变化的因素进行模型分析，首先分别采用ARIMA模型和BP神经网络模型对原始数据进行建模分析。使用两种模型分别建模分析得出预测结果。并使用并联型ARIMA-BP混合模型对两种算法拟合出的结果对单一模型进行各自权重计算，最终添加权重信息对未来气候进行预测。

**ARIMA模型**全称为自回归移动平均模型(Autoregressive Integrated Moving Average Model，简记ARIMA)。其中ARIMA(p，d，q)称为差分自回归移动平均模型，AR是自回归，P为自回归项。ARIMA模型可分为3种:(1)自回归模型(简称AR模型);(2)移动平均模型(简称MA模型);(3)自回归滑动平均混合模型(简称ARIMA模型)。本题中需要针对过去一段时间的气候因素变化值来预测未来一段时间内的数据变化趋势，需要进行长期预测，因此本文中需要使用移动平均模型。

**移动平均法**是通过对近期的一系列实际数据值，来预测未来一段时间或某几段时间内数据的方法，其没有快速增长或下降趋势的系列，能够较好的进行长期预测。其有q阶的MA模型结构公式如下所示：

​                                                    ![1569509433178](C:\Users\83759\AppData\Roaming\Typora\typora-user-images\1569509433178.png)      

公式中   代表移动平均参数，   代表序列中的残差，当   时，成为中心化模型。并联型组合模型的基本思想就是对原始时间序列数据利用不同的预测方法进行加权平均组合，分别赋予各个模型合适的权重，最后进行融合，从而得到更为精确的预测值。而各种预测模型所对应的权重反映了各自预测方法对最后所得预测结果的贡献大小，也就是说，误差越大，其在组合预测模型中权重越小，贡献就越小；反之，误差越小，其在组合预测模型中权重越大，贡献也就越大。

   ![1569509493890](C:\Users\83759\AppData\Roaming\Typora\typora-user-images\1569509493890.png)

 并联型ARIMA-BP算法模型原理图

并联型组合模型公式如下所示：

​                ![1569509513857](C:\Users\83759\AppData\Roaming\Typora\typora-user-images\1569509513857.png)   

其中，w代表单一模型的权重，G1(x)代表时间序列模型在x时间下的预测值，G2(x)代表神经网络模型在x时间下的预测值。

![1569509672822](C:\Users\83759\AppData\Roaming\Typora\typora-user-images\1569509672822.png)

##  气象因子的历史变化特征及预测模型

影响气候形成和变化的因子包括内部因子和外部因子两大类。内部因子是指气候系统内的热力、动力和下垫面诸因子及其相互作用。外部因子是指宇宙及地球内部因子（来自气候系统下边界以下的地球内力作用）和人类活动因子。具体来说全球气候变化的影响因素主要有大气上界辐射变化、温室气体变化、气溶胶、地震潮汐和火山活动、北极海冰、构造抬升、下垫面物理景观变化及世界人口等人为因素。影响全球气候变化的机制有外部强迫和大气系统内部自然变化两类。从地气系统辐射平衡原理出发，外部强迫机制主要是由于地球轨道参数变化和太阳活动引起的大气上界辐射及其分布的变化、大气温室气体的变化、气溶胶变化与火山活动、下垫面物理景观变化等，这些变化通过影响地—气系统辐射和热量、水分平衡而驱动全球长期气候变化。长期天气过程变化的众多外生变量因子影响.基于这样的分析，本题尝试利用人工神经网络方法结合自回归移动平均模型方法，进行一种混合长期气候预测的建模研究。模型算法流程如下所示：

![1569509713117](C:\Users\83759\AppData\Roaming\Typora\typora-user-images\1569509713117.png)

## **建模前准备工作**

在建立未来25年气候变化趋势时，需要首先进行建模前准备：

（1）查找汇总全球过去80年的平均温度及温度极值变化情况、平均降水量及极值变化、海平面平均上升情况求解表达式如下：

​        ![1569509742523](C:\Users\83759\AppData\Roaming\Typora\typora-user-images\1569509742523.png)

（2）查找汇总全球过去80年的地球辐射变化，包括平均二氧化碳排放量变化情况、气溶胶变化情况以及地球反射率、太阳辐射等变化情况.并且将这几种影响地球温度变化的量转化为全球强迫辐射量。转化公式如下所示：

​                                          ![1569509764541](C:\Users\83759\AppData\Roaming\Typora\typora-user-images\1569509764541.png)                         （5.4）

对上述公式进行处理，可得出太阳辐射强迫量与全球气温变化的公式为:     

​                   ![1569509779784](C:\Users\83759\AppData\Roaming\Typora\typora-user-images\1569509779784.png)            （5.5）

上式中*Tn*是第n年的温度，   为地球辐射强迫量。F为净辐射量。

##  **数据收集及数据预处理**

本文中的全球降水量、全球平均气温、全球二氧化碳排放量等数据均来自网站官方数据，对以上数据采集，并进行统计。在对数据分析前首先要对数据进行预处理；

#### （1）缺失数据预处理

本题取近一百年的气候变化数据进行预测，而由于本题中数据量较大，遗失数据也较多，因此首先应对缺失数据进行补充。本题拟采用线性插值对缺失数据进行补充。对1918年-2018年期间100年的每年气温平均值、降水量均值、气温最大值、气温最小值进行拉格朗日插值处理，进行补充。

![1569509806205](C:\Users\83759\AppData\Roaming\Typora\typora-user-images\1569509806205.png)



其中x1到x100代表自1918年-2018年间的温度值。

#### （2）影响因素变为同一量纲

任意一个物体都会根据自身的温度通过特定的波长来对外辐射一定量的能量。由于地球被大气层所包围，加之有海洋的调解作用，地球表面不会因昼夜、季节及纬度的不同而产生很大的温度差异。例如，海洋性气候的气温日较差很小，据估计全世界海洋上气温平均日较差仅为℃，这是由于水具有较大的热量惯性，其温度振幅极小，使得海面上方气温日较差小。内陆的气温日较差则要大一些，例如我国西部内陆上方气温日较差达℃以上。但是，由于地球接受太阳辐射的面积一一即地球的纵切面一基本保持不变而且随着地球的公转有周期性的变化，因此对于地球上的任意一个地方的年较差一般说来会较小。由此我们利用黑体辐射原理来估计地球表面平均温度是可行的，也是有现实意义的。本题中，由于采用不同因素描述地球气候变化，不同的因素具有不同的量纲，为了方便计算，将所有因素都转化为辐射强迫量，以便于后续计算。其中，各种温室气体排放量与辐射强迫量之间的关系如下表中所示：

![1569509840910](C:\Users\83759\AppData\Roaming\Typora\typora-user-images\1569509840910.png)

![1569509855016](C:\Users\83759\AppData\Roaming\Typora\typora-user-images\1569509855016.png)

#### (3)数据聚合处理

基于气候预测主题，需要将历史百年的数据进行降维聚合，将每五年的气候数据划分为一个气候变化单位，即在观测历史天气和预测未来气候变化情况时，将五年气候数据的平均进行简单加和求平均操作。

#### (4)归一化处理

数据归一化是数据标准化处理的一种，其目的是将有量纲的表达式经数学变换后转化为无量纲的表达式，并将数据映射到［0，1］的区间上。本文中用到的BP神经网络学习算法的不同输入变量的范围差异较大，因此需要对数据进行归一化处理。总的来说，归一化能够使不同维度之间的特征在数值上有一定比较性，数据经归一化处理后可以提升模型的收敛速度以及模型的精度。归一化的方式主要有离差标准化、和Z-Score标准化和函数变换等。

归一化之后的数据范围均在［0，1］之间，在完成对原始数据的预处理操作后，开始对模型进行构建与验证。



### ****太阳辐射量预测模型与求解**

太阳活动是影响太阳发出辐射的主要因素，具有较明显的周期性变化。太阳黑子的多发期与太阳光斑、耀斑和日珥数目的增加相联系，结果使太阳总辐射增加。尽管因太阳活动引起的太阳常数变化不足1%，但许多学者从气候记录中鉴别出太阳活动的11年和22年周期，并与树木年轮再现的气候数据相对应。区域性的旱、涝有较明显的11年和22年周期，这与太阳周期有关。此外，太阳活动与温、压、湿等其它气候要素的变化也有一定联系。*Christensen*发现，对流层和平流层上部的温度与太阳活动11-12年周期有同步关系，在更长尺度上，北半球陆面气温与太阳活动的长期变化有理想的关系，这一点不仅表现在黑子数上，更表现在太阳10-12年左右周期的长度变化上。1980年以来，卫星用于太阳辐射测定，从数日至数年的尺度上看，太阳辐射是随太阳黑子数而变化的，这是太阳活动对辐射和气候影响的有力证据之一.

#### **太阳辐射数据的平稳性分析和差分预处理**

本部分研究是通过整理1881-2018年的太阳辐射强迫变化与年份之间的关系，数据来源NASA，具体数据表格见附件2所示。

![1569509940439](C:\Users\83759\AppData\Roaming\Typora\typora-user-images\1569509940439.png)

由图片可知，太阳辐射强度变化随着年份增加而增加，且进入21世纪以来太阳辐射强度变化强度有所激增。本题拟使用ARIMA-BP模型对其进行建模，但由于太阳辐射走势具有一定趋势性，且整体波动较大数据不平稳，需要进行平稳性预测和差分处理。本文采用SPASS软件进行分析

![1569509951102](C:\Users\83759\AppData\Roaming\Typora\typora-user-images\1569509951102.png)

接着对序列的自相关图（ACF）和偏自相关图（PACF）进行分析，来进行时间序列的模型判别。不同主题下的预测模型建立与实现方法类型，主要区别在于输入的数据不同以及模型调参的过程。下方为一阶差分后的ACF和PACF图：

![1569509976341](C:\Users\83759\AppData\Roaming\Typora\typora-user-images\1569509976341.png)

根据观察ACF和PACF图判断其拖尾和结尾特性，并确定模型的PQ值。最终确定模型为ARIMA(1，2，1).

![1569509997810](C:\Users\83759\AppData\Roaming\Typora\typora-user-images\1569509997810.png)

使用模型拟合的曲线图如下所示：

![1569510023564](C:\Users\83759\AppData\Roaming\Typora\typora-user-images\1569510023564.png)

图5.7 太阳辐射强迫拟合曲线图

得到模型平稳的R方为0.153，sig值为0.133，效果较为显著。在拟合图中，观测值与拟合值曲线走势较温和。拟合效果好。因此模型ARIMA（1，2，1）的显著性、可用性通过检验。

#### ****温室气体变化预测模型与求解**

温室气体包含以二氧化碳为代表的多种碳化物和氮化物气体。但导致全球温室效应的主要气体是二氧化碳。本题中以对全球升温贡献较大的二氧化碳进行分析。数据来源于NASA。变化曲线图如下所示：

从图中可知，自年由浓度除了在上个世纪年代有小幅下降外，根据其余基本上都成增长趋势，尤其年代以后增长速度尤其快。根据IPCC(2001)提供的辐射强迫计算公式:

​    ![1569510053911](C:\Users\83759\AppData\Roaming\Typora\typora-user-images\1569510053911.png)    （5.8）

可将全球二氧化碳排放量转换为辐射强度，具体换算数据如附表3所示。

由全球二氧化碳排放总量变化曲线可知，全球二氧化碳排放自上世纪50年代后激增，可能与人类上世纪第一次工业革命后开始使用化石能源，且对大气的二氧化碳排放量变多。从而导致二氧化碳排放量激增。使用SPASS软件对二氧化碳排放量进行拟合预测。使用ARIMA时间序列模型进行预测，结果如下所示：

![1569510073183](C:\Users\83759\AppData\Roaming\Typora\typora-user-images\1569510073183.png)

## **影响气候变化因素的相关性分析**

以上描述了多种影响气候变化的因素，现需要对各影响因素进行相关性分析，以定量分析其对气候变化的相关性系数。相关性分析描述了多个或两个变量之间的相关程度或者紧密程度，能够反映的都是两个变量之间变化趋势的方向以及程度。通过对不同特征或数据间的关系进行分析，发现数据中的关键影响及驱动因素，并在此基础上优化预测算法。目前存在三个相关性系数（皮尔森相关系数，斯皮尔曼相关性系数，肯德尔相关性系数）反映的都是两个变量之间变化趋势的方向以及程度。本题选取斯皮尔曼相关性系数进行相关性分析。该系数对变量之间是否存在线性关系，样本容量的大小没有严格要求。计算该相关系数时，当两个变量对应数值所在的集合中，找不到两个相同的元素。那么，当其中一个变量可以表示为另一个变量的单调函数，它的计算公式见公式：

![1569510113347](C:\Users\83759\AppData\Roaming\Typora\typora-user-images\1569510113347.png)

其中，M代表集合中元素的个数，d为二列成对变量的等级差数。斯皮尔曼等级相关系数对数据条件的要求没有皮尔逊系数严格，不论两个变量的总体分布形态与样本容量的大小如何，斯皮尔曼等级系数都可用于相关性的研究。

本题使用Spass工具对影响气候变化的几个因素进行相关性分析。并将相关系数统计如下表所示：

![1569510136650](C:\Users\83759\AppData\Roaming\Typora\typora-user-images\1569510136650.png)

## **过去百年气候总结**

经上述分析可知，1881-2018年全球气温均呈上升趋势，且趋势及其显著，全球线性增温率为0.023℃/a，各地区中华北地区线性增温速率最高，为0.03℃/a，西南线性增温速率最低，为0.16℃/a为。季节气温方面：各地区和全球过去四季气温均呈上升趋势。

![1569510193223](C:\Users\83759\AppData\Roaming\Typora\typora-user-images\1569510193223.png)

年际降水量方面：除非洲地区呈减少趋势外，其它六个地区和全球均呈不同程度增加趋势。全球年际降水量线性增加速率为0.94mm/a，各地区中亚洲地区年际降水量线性增加速率最高，为1.678mm/a，欧洲年际降水量线性增加速率最低，为0.327mm/a。

![1569510209544](C:\Users\83759\AppData\Roaming\Typora\typora-user-images\1569510209544.png)

## **未来气候变化特征**

未来中长期全球气候变化可能呈现整体变暖、局部降温的趋势。全球平均气温和海温升高，大范围积雪和冰融化，从全球平均海平面上升的观测中可以看出气候系统变暖是明显的，已观测到的积雪和海冰面积减少也与变暖相一致。从世界各国气候模式最新的预估结果来看，未来升温趋势可能延续。但预估结果同时显示，全球变暖并不是意味着每个地区都普遍升温，不排除某些区域会出现降温。

气候变化可能呈现稳定性与突变性并存的特点。从未来25年来看，未来气候变化呈现一定稳定性，但局部又有一定突变性。模拟结果表明，当温室气体排放率大于或等于当前排放率时，未来25年气候变化很有可能比20世纪观测到的还要剧烈。即使立即减少温室气体排放量，将温室气体浓度维持在目前水平，气候变化也将持续几个世纪。气候变化的这种“惯性”，源于许多种因素的共同作用，比如海洋的热容量，以及大气环流达到新平衡所需的上千年时间（只有这样才能将大气中的热量和二氧化碳与整个深海均匀混合，从而在新条件下达到新的平衡）。